$new_arr = []
class Board
  def initialize(pieces)
    @pieces = pieces
    $pieces_arr = []
    i = 1
    1.upto(pieces) do |piece|
      piece = i
      $pieces_arr.push(piece)
      if piece % 3 == 0 
        puts "|_#{piece}_|"
      else print "|_#{piece}_|" end
      i += 1
    end
  end
  def player_pick(pick)
    $pick = pick
  end
  def new_board 
    x = 1
    for piece in $new_arr
      if x % 3 == 0 
        puts "|_#{piece}_|"
      else print "|_#{piece}_|" end
        x += 1
    end
    $pieces_arr = $new_arr
  end
end

class Computer
  def initialize 
    $rand_num = rand(1..9)
    while $pick == $rand_num 
      $rand_num = rand(1..9)
     end  #(!)
  end
  def change_num
    @new_num_arr = $new_arr.select { |element| element.class == Integer}
    $rand_num = @new_num_arr.shuffle.first()
    while $pick == $rand_num
    $rand_num = @new_num_arr.shuffle.first()
    end
    puts "the rng is #{$rand_num}"
  end
end
class Player_Input
  def initialize(first_round)
    @first_round = first_round
  end
  def state_first_round
    if @first_round.downcase() == "no"  
      puts "a"
    elsif @first_round.downcase() == "yes"  
      player_first = true 
      puts player_first
    end
  end
end

class Game_score
  def initialize
    puts "You picked #{$pick}, and computer picked #{$rand_num}"
    for piece in $pieces_arr
      if piece.to_i == $pick.to_i
        $new_arr.push("X")
      elsif piece.to_i == $rand_num.to_i
        $new_arr.push("O")
      else $new_arr.push(piece)
      end
    end
    def new_values
      $new_arr = []
      puts "You picked #{$pick}, and computer picked #{$rand_num}"
      for piece in $pieces_arr
        if piece == $pick.to_i
          $new_arr.push("X")
        elsif piece == $rand_num
          $new_arr.push("O")
        else $new_arr.push(piece)
        end
       end
    end
  end
  def check_if_won
      $more_rounds = false
      if $new_arr[0] == "X" && $new_arr[1] == "X" && $new_arr[2] == "X"
        puts "You won!"
      elsif $new_arr[3] == "X" && $new_arr[4] == "X" && $new_arr[5] == "X"
        puts "You won!"
      elsif $new_arr[6] == "X" && $new_arr[7] == "X" && $new_arr[8] == "X"
        puts "You won!"
      elsif $new_arr[0] == "X" && $new_arr[3] == "X" && $new_arr[6] == "X"
        puts "You won!"
      elsif $new_arr[1] == "X" && $new_arr[4] == "X" && $new_arr[7] == "X"
        puts "You won!"
      elsif $new_arr[2] == "X" && $new_arr[5] == "X" && $new_arr[8] == "X"
        puts "You won!"
      elsif $new_arr[0] == "X" && $new_arr[4] == "X" && $new_arr[8] == "X"
        puts "You won!"
      elsif $new_arr[2] == "X" && $new_arr[4] == "X" && $new_arr[6] == "X"
        puts "You won!" 
      elsif $new_arr[0] == "O" && $new_arr[1] == "O" && $new_arr[2] == "O"
        puts "You Lost"
      elsif $new_arr[3] == "O" && $new_arr[4] == "O" && $new_arr[5] == "O"
        puts "You Lost"
      elsif $new_arr[6] == "O" && $new_arr[7] == "O" && $new_arr[8] == "O"
        puts "You Lost"
      elsif $new_arr[0] == "O" && $new_arr[3] == "O" && $new_arr[6] == "O"
        puts "You Lost"
      elsif $new_arr[1] == "O" && $new_arr[4] == "O" && $new_arr[7] == "O"
        puts "You Lost"
      elsif $new_arr[2] == "O" && $new_arr[5] == "O" && $new_arr[8] == "O"
        puts "You Lost"
      elsif $new_arr[0] == "O" && $new_arr[4] == "O" && $new_arr[8] == "O"
        puts "You Lost"
      elsif $new_arr[2] == "O" && $new_arr[4] == "O" && $new_arr[6] == "O"
        puts "You Lost"
      else $more_rounds = true end
  end
end

b = Board.new(9)
puts "Do you want to go first" #(!)
first_round = gets
player = Player_Input.new(first_round)
player.state_first_round
puts "What number would you like to pick"
pick = gets
b.player_pick(pick)
comp = Computer.new
game = Game_score.new
b.new_board
puts "What number would you like to pick next"
pick = gets
b.player_pick(pick)
comp.change_num
game.new_values
game.check_if_won
b.new_board
num_of_rounds = 0
while $more_rounds == true && num_of_rounds <= 5
  puts "What number would you like to pick next"
  pick = gets
  b.player_pick(pick)
  comp.change_num
  game.new_values
  game.check_if_won
  b.new_board
  num_of_rounds +=1
end
